{% extends 'front/employee_home/index.html.twig' %}

{% block title %}My Travels - TripEase{% endblock %}

{% block head%}
<link href='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/main.min.css' rel='stylesheet' />
<script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/main.min.js'></script>

{% endblock %}

{% block nav %}
        <ul>
          <li><a href="{{ path('app_employee_home') }}" >Home</a></li>
          <li><a href="{{ path('app_my_travels') }}" class="active" >Mes voyages</a></li>
          <li><a href="{{ path('app_expenses') }}">Expenses</a></li>
          <li><a href="{{ path('app_transport_list') }}">Book Transport</a></li>
          <li><a href="{{ path('app_statut_index') }}">Forum</a></li>
          <li class="dropdown">
            <a href="#"><span>Account</span> <i class="bi bi-chevron-down toggle-dropdown"></i></a>
            <ul>
              <li><a href="{{ path('app_user_settings') }}">Settings</a></li>
              <li><a href="{{ path('app_logout') }}">Logout</a></li>
            </ul>
          </li>
        </ul>
        {% endblock %}

{% block body %}
<div class="d-flex justify-content-between align-items-start flex-wrap calendar-layout">
<section class="container py-5">
    <h1 class="mb-4 text-center">Mes Voyages</h1>
    <div class="voyage-cards">
        {% for voyage in voyages %}
            
            <div class="voyage-card" onclick="location.href='{{ path('app_voyage_show_employee', {'id': voyage.id}) }}'">
                <h3 class="voyage-title">âœˆ {{ voyage.title }}</h3>
                <p class="voyage-date">ðŸ“… DÃ©but : {{ voyage.dateDepart ? voyage.dateDepart|date('d M Y') : 'Non dÃ©fini' }}</p>
                <p class="voyage-date">ðŸ“… Fin : {{ voyage.dateRetour ? voyage.dateRetour|date('d M Y') : 'Non dÃ©fini' }}</p>
                <p class="voyage-etat">ðŸ“Œ Ã‰tat : {{ voyage.etat }}</p>
                <a href="{{ path('app_voyage_show_employee', {'id': voyage.id}) }}" class="btn-details">Voir DÃ©tails</a>
            </div>
            
        {% else %}
            <p>Aucun voyage trouvÃ©.</p>
        {% endfor %}
    </div>
</section>

<section class="container py-5">
  <h2 class="text-center mb-3">ðŸ“… Calendrier de mes voyages</h2>
  <div id="calendar"></div>
</section>
</div>


{% endblock %}

{% block scripts %}

<script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.9/index.global.min.js'></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    const calendarEl = document.getElementById('calendar');
    const calendar = new FullCalendar.Calendar(calendarEl, {
        initialView: 'dayGridMonth',
        locale: 'fr',
        firstDay: 1,
        headerToolbar: {
            left: 'prev,next today',
            center: 'title',
            right: 'dayGridMonth,timeGridWeek,timeGridDay'
        },
        events: {{ calendarEvents|json_encode|raw }},
        eventClick: function(info) {
            if (info.event.url) {
                window.location.href = info.event.url;
            }
        }
    });
    calendar.render();
});
</script>
{% endblock %}

{% block styles %}

{{ parent() }}
 <style>

 


.calendar-layout {
    display: flex;
    gap: 30px;
    padding: 20px;
    flex-wrap: wrap;
  }
  
  .voyages-section {
    flex: 1;
    min-width: 300px;
  }
  
  .calendar-section {
    flex: 1;
    min-width: 400px;
  }
  
  #calendar {
    max-width: 100%;
  }
 </style>

  {% endblock %}