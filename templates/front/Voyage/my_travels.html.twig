{% extends 'front/employee_home/index.html.twig' %}

{% block body %}
<div class="travel-container">
    <!-- Section Voyages (Gauche) -->
    <section class="voyages-section">
        <h1 class="mb-4">Mes Voyages</h1>
        
        {% if voyages|length > 0 %}
            {% for voyage in voyages %}
                <div class="voyage-card" onclick="location.href='{{ path('app_voyage_show_employee', {'id': voyage.id}) }}'">
                    <h3 class="voyage-title">âœˆ {{ voyage.title }}</h3>
                    <p class="voyage-date">ðŸ“… DÃ©but : {{ voyage.dateDepart ? voyage.dateDepart|date('d M Y') : 'Non dÃ©fini' }}</p>
                    <p class="voyage-date">ðŸ“… Fin : {{ voyage.dateRetour ? voyage.dateRetour|date('d M Y') : 'Non dÃ©fini' }}</p>
                    <p class="voyage-etat">ðŸ“Œ Ã‰tat : 
                        <span class="badge bg-{{ voyage.etat == 'ValidÃ©' ? 'success' : (voyage.etat == 'RefusÃ©' ? 'danger' : 'warning') }}">
                            {{ voyage.etat }}
                        </span>
                    </p>
                    <a href="{{ path('app_voyage_show_employee', {'id': voyage.id}) }}" class="btn-details">Voir DÃ©tails</a>
                </div>
            {% endfor %}
        {% else %}
            <div class="alert alert-info">Aucun voyage trouvÃ©.</div>
        {% endif %}
    </section>

    <!-- Section Calendrier (Droite) -->
    <section class="calendar-section">
        <h2 class="mb-4">ðŸ“… Calendrier de mes voyages</h2>
        <div id="calendar"></div>
    </section>
</div>
{% endblock %}

{% block scripts %}
{{ parent() }}
<script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.9/index.global.min.js'></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    const calendarEl = document.getElementById('calendar');
    const calendar = new FullCalendar.Calendar(calendarEl, {
        initialView: 'dayGridMonth',
        locale: 'fr',
        firstDay: 1,
        headerToolbar: {
            left: 'prev,next today',
            center: 'title',
            right: 'dayGridMonth,timeGridWeek,timeGridDay'
        },
        events: {{ calendarEvents|json_encode|raw }},
        eventClick: function(info) {
            if (info.event.url) {
                window.location.href = info.event.url;
            }
        },
        height: 'auto' // Ajuste la hauteur automatiquement
    });
    calendar.render();
});
</script>
{% endblock %}


{% block styles %}
{{ parent() }}
<style>
    /* Supprime le preloader si nÃ©cessaire */
    #preloader {
        display: none !important;
    }

    /* Conteneur principal flex */
    .travel-container {
        display: flex;
        gap: 30px;
        padding: 20px;
        max-width: 1400px;
        margin: 0 auto;
    }

    /* Section voyages (gauche) */
    .voyages-section {
        flex: 1;
        min-width: 400px;
        max-width: 600px;
    }

    /* Section calendrier (droite) */
    .calendar-section {
        flex: 1;
        min-width: 500px;
        position: sticky;
        top: 20px;
        align-self: flex-start;
    }

    /* Styles des cartes de voyage */
    .voyage-card {
        border: 1px solid #e0e0e0;
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 20px;
        transition: all 0.3s ease;
        background: white;
    }

    .voyage-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }

    .voyage-title {
        color: #2c3e50;
        margin-bottom: 15px;
    }

    .voyage-date {
        color: #7f8c8d;
        margin-bottom: 8px;
    }

    .voyage-etat {
        font-weight: 500;
    }

    .btn-details {
        display: inline-block;
        margin-top: 15px;
        padding: 8px 15px;
        background-color: #8cddcd;
        color: white;
        border-radius: 4px;
        text-decoration: none;
    }

    /* Responsive */
    @media (max-width: 992px) {
        .travel-container {
            flex-direction: column;
        }
        
        .voyages-section,
        .calendar-section {
            min-width: 100%;
        }
    }
</style>
{% endblock %}
